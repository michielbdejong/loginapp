<script language="JavaScript" type="text/javascript" src="../unhosted/prng4.js"></script>
<script language="JavaScript" type="text/javascript" src="../unhosted/rng.js"></script>
<script language="JavaScript" type="text/javascript" src="../unhosted/rijndael.js"></script>
<script language="JavaScript" type="text/javascript" src="../unhosted/sha1.js"></script>
<script language="JavaScript" type="text/javascript" src="../unhosted/jsbn.js"></script>
<script language="JavaScript" type="text/javascript" src="../unhosted/unhosted.js"></script>
<script>
var args = {};
function getArgs() {
	var parts = document.location.href.split('?', 2);
	var argSpecs = parts[1].split('&');
	var argParts;
	for(i in argSpecs){
		argParts=argSpecs[i].split('=', 2);
		args[argParts[0]]=argParts[1];
	}
}
function setAppAndEmail() {
	getArgs();
	document.getElementById("appNameSpan").innerHTML=args['app'];
	document.getElementById("emailSpan").innerHTML=args['guid'];
	document.getElementById("emailInput").value=args['guid'];
}
function cancel() {
	window.close();
}
function authorize() {
	var pwd = document.getElementById("passwordInput").value;
	unhosted.importWallet(args['guid'], 'grommace.com', pwd);
	unhosted.givePopShake(args['guid'], args['app']);
	var callbackUrl ="http://"+args['app']+"/";
	window.location =  callbackUrl;
}
</script>
<html>
<body onload="setAppAndEmail();" bgcolor="FFAAAA">
<H2>LovePoems.org PopShake Dialogue</H2>
If you want to authorize <strong><span id="appNameSpan">unknown app</span></strong> to store data into your unhosted storage at <strong><span id="emailSpan">unknown</span></strong>, then please type your LovePoems.org password below, and hit 'Authorize'. If not, hit 'Cancel'.<br/>
LovePoems.org Login:<br/>
<table>
<tr><td>Email: </td><td><input type="text" id="emailInput" disabled="true"/></td></tr>
<tr><td>Password: </td><td> <input type="text" id="passwordInput"/></td></tr>
</table>
<input type="button" value="Cancel" onclick="cancel();"/>
<input type="button" value="Authorize" onclick="authorize();"/>
</body>
</html>
